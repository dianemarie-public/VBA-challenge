Sub test()

'*************

' Create a script to loop through all the stocks for one year and output:
' Ticker symbol
' Yearly change
' Percent change
' Total volume
' Conditionally format highlighting:
' Positive change in green
' Negative change in red
' Challenge:
' Return the stock with the greatest percentage increase
' Return the stock with the greatest percentage decrease
' Return the stock with the greatest total volume

' ************

'My enhancements:
' Parse the data column into: year, month, day and create a new column with the date format dd/mm/yyyy
' Format stock prices as currency
' Format volume as standard (or other with comma separators
' Create a summary sheet and copy summary data for each stock symbol with yearly change and total volume

' ************

'Create a for loop for all worksheets
For Each ws In Worksheets

    'Create variables
    Dim year As String
    Dim ticker_symbol As String
    Dim open_price As Double
    Dim close_price As Double
    Dim daily_volume As Long
       
    'Create calculated variables
    
    Dim daily_change As Double
    Dim yearly_change As Double
    Dim percent_change As Double
    Dim total_volume As Long
    Dim positive_change As Boolean
    Dim negative_change As Boolean
    Dim greatest_increase As Boolean
    Dim greatest_decrease As Boolean
    Dim greatest_volume As Boolean
        
    'Count the non-empty rows and columns
    'Ref website: Automate Excel here https://www.automateexcel.com/vba/find-last-row-column-cell/
    'Format the row and column count with numbers and comma separators
    'Ref website: Tech On The Next here https://www.techonthenet.com/excel/formulas/format_number.php
            
    last_row = Format(ws.UsedRange.Rows.Count, "#,##0")
    last_column = Format(ws.UsedRange.Columns.Count, "#,##0")
    
    'Set the initial value of each variable
    year = ws.Name
      
    'Create headers
    ws.Range("H1").Value = "Daily Change"
    ws.Range("J1").Value = "Ticker Symbol"
    ws.Range("K1").Value = "Yearly Change"
    ws.Range("L1").Value = "Percent Change"
    ws.Range("M1").Value = "Total Volume"
    ws.Range("O1").Value = "Greatest % Increase"
    ws.Range("O2").Value = "Greatest % Decrease"
    ws.Range("O3").Value = "Greatest Total Volume"
    
    
    'Create loop of worksheet through the non-empty rows
    'Ref website: Stack Overflow here https://stackoverflow.com/questions/62471422/vba-loop-how-to-get-ticker-symbols-into-ticker-column
    For i = 2 To last_row
       
        'Calculate the daily change in price and add to column H
        ws.Cells(i, 8).Value = Format(ws.Cells(i, 6).Value - ws.Cells(i, 3).Value, "Currency")
                             
        'Conditional statement, if the next row does not equal the previous row, then set the ticker symbol
        'If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then
                     
        'Else statement
        'Else
        
        'Close if statement
        'End If
    
    'Next row
    Next i
        
    'temp msgbox for worksheet name test
    'MsgBox ("Worksheet named " & year & " has " & last_row & " rows, and " & last_column & " columns.")
    
Next ws

End Sub

